$(document).ready(function(){function e(){function e(e){var t=e?e.split("?")[1]:window.location.search.slice(1),n={};if(t)for(var i=(t=t.split("#")[0]).split("&"),o=0;o<i.length;o++){var a=i[o].split("="),r=a[0],c="undefined"==typeof a[1]||a[1];if(r=r.toLowerCase(),"string"==typeof c&&(c=c.toLowerCase()),r.match(/\[(\d+)?\]$/)){var l=r.replace(/\[(\d+)?\]/,"");if(n[l]||(n[l]=[]),r.match(/\[\d+\]$/)){var s=/\[(\d+)\]/.exec(r)[1];n[l][s]=c}else n[l].push(c)}else n[r]?n[r]&&"string"==typeof n[r]?(n[r]=[n[r]],n[r].push(c)):n[r].push(c):n[r]=c}return n}function t(e,t){(document.getElementById("month-"+Y).classList.remove("active"),document.getElementById("month-"+e).classList.add("active"),Y=e,t)&&document.querySelector(".months-wrap .active").scrollIntoView()}function n(e){var t=document.querySelector(".very-custom-calendar-wrap .calendar-current-date .month-placeholder"),n=document.querySelector(".very-custom-calendar-wrap .calendar-current-date .day-placeholder");t.innerText=e.format("dddd ."),n.innerText=e.format("D MMM")}function i(e,t,n,i){return e<i&&t<n}function o(){$("#newEventAddDetails").removeClass("d-none"),$("#newEventAddDetailsBtn").addClass("d-none")}function a(){$("#newEventAddDetails").addClass("d-none"),$("#newEventAddDetailsBtn").removeClass("d-none")}function r(e){var t=e.startTime,n=e.endTime,i=e.setDate,r=e.title,c=e.description;$("#newEventStartTimepicker").val(t),$("#newEventEndTimepicker").val(n),$("#newEventDatePicker").val(i),r?$("#newEventSubject").val(r):$("#newEventSubject").val(""),c?($("#newEventAddDetailsTextArea").val(c),o()):($("#newEventAddDetailsTextArea").val(""),a())}function c(e){var t=e.startTime,n=e.endTime,i=e.setDate,o=e.title,a=e.description;$("#newEventStartTimepickerMoreOption").val(t),$("#newEventEndTimepickerMoreOption").val(n),$("#newEventDatePickerMoreOption").val(i),$("#newEventMoreOptionsCurrentDate").text(i),$("#newEventDatePickerMoreOption").change(function(){M=$("#newEventDatePickerMoreOption").val()}),$("#newEventStartTimepickerMoreOption").change(function(){k=$("#newEventStartTimepickerMoreOption").val()}),$("#newEventEndTimepickerMoreOption").change(function(){E=$("#newEventEndTimepickerMoreOption").val()}),o&&$("#newEventSubjectMoreOption").val(o),a&&$("#newEventAddDetailsTextAreaMoreOption").val(a)}function l(){var e='<div class="position-relative mt-3">\n                        <select class="custom-select mr-2 fz-14 gray-input d-inline-block notification-select">\n                          <option value="email" selected>Email</option>\n                          <option value="notification">Notification</option>\n                        </select>\n\n                        <input type="text" class="form-control mr-2 gray-input d-inline-block notification-duration-input" placeholder="30">\n\n                        <select class="custom-select fz-14 gray-input d-inline-block notification-duration-type-input">\n                          <option value="minutes" selected>minutes</option>\n                          <option value="hours">hours</option>\n                          <option value="days">days</option>\n                          <option value="weeks">weeks</option>\n                        </select>\n\n                        <button type="button" class="d-inline-block btn btn-link btn-link-close" aria-label="Close">\n                          <span aria-hidden="true">&times;</span>\n                        </button>\n                    </div>',t=document.createElement("div");t.innerHTML=e,$("#notif-wrap").append(t),$(t).find(".btn-link-close").on("click",function(){s($(this))})}function s(e){$(e).parent().remove()}function d(e){return e||(e={}),Object.assign({header:{left:"",center:"",right:""},plugins:["dayGrid","timeGrid","interaction"],defaultView:"timeGridDay",nowIndicator:!0,allDaySlot:!1,contentHeight:800,selectable:!0,selectHelper:!0,eventOverlap:!1,slotDuration:"00:15",datesRender:function(){Array.from(document.querySelectorAll(".fc-scroller")).forEach(function(e){new PerfectScrollbar(e)})},eventClick:function(){},select:function(e){var t=D.view.type,n=moment.utc(moment(e.end).diff(moment(e.start))).valueOf();if(Math.floor(n/6e4)>("timeGridDay"===t?60:1440))D.unselect(),$("#newEventMultipleTimeSelect").modal();else{if(D.getEvents().some(function(t){return!(!t.start||!t.end)&&i(t.start.getTime(),e.start.getTime(),t.end.getTime(),e.end.getTime())}))return void $("#newEventTimeConflict").modal();$.getScript("/sessions/new",function(){r({startTime:moment(e.start).format("hh:mm A"),endTime:moment(e.end).format("hh:mm A"),setDate:moment(e.start).format("D MMM YYYY")}),k=moment(e.start).format("hh:mm A"),E=moment(e.end).format("hh:mm A"),M=moment(e.start).format("D MMM YYYY"),$("#newEventDialog form").submit(function(){return $(".start_hidden").val(M+" "+k),$(".end_hidden").val(M+" "+E),p(),!0}),$("#newEventDialog").removeClass("edit-view").modal(),$("#newEventAddDetailsBtn").on("click",function(){o()}),$("#newEventMoreOptionBtn").on("click",function(){$("#newEventMoreOptionDialog").modal(),c({startTime:$("#newEventStartTimepicker").val(),endTime:$("#newEventEndTimepicker").val(),setDate:$("#newEventDatePicker").val(),title:$("#booking_title").val(),description:$("#newEventAddDetailsTextArea").val()})}),$(".new-event-time-picker").mdtimepicker(),$("#newEventStartTimepicker").mdtimepicker().on("timechanged",function(e){k=e.value}),$("#newEventEndTimepicker").mdtimepicker().on("timechanged",function(e){E=e.value}),$(".new-event-date-picker").bootstrapMaterialDatePicker({weekStart:0,time:!1,format:"D MMM YYYY"}),$(".new-event-date-picker").change(function(e){M=e.target.value})})}},events:function(e,t,n){$(".gooey-wrap").removeClass("d-none");var i=function(e){$(".gooey-wrap").addClass("d-none"),n(e)},o=function(e){$(".gooey-wrap").addClass("d-none"),t(e)};w&&f?$.ajax({url:"/bookings.json"+window.location.search+"&self=1&other=1",dataType:"JSON",success:o,error:i}):!w&&f?$.ajax({url:"/bookings.json"+window.location.search+"&self=1&other=0",dataType:"JSON",success:o,error:i}):w&&!f?$.ajax({url:"/bookings.json"+window.location.search+"&self=0&other=1",dataType:"JSON",success:o,error:i}):$.ajax({url:"/bookings.json"+window.location.search+"&self=0&other=0",dataType:"JSON",success:o,error:i})},eventRender:function(e){var t=e.event.extendedProps.eventDescription,n=e.event.extendedProps.eventName,i=e.event.extendedProps.hasStar;if(t){var o=document.createElement("div");o.innerText=t,o.classList.add("fc-event-description"),e.el.append(o)}if(n){var a=document.createElement("div");a.innerText=n,a.classList.add("fc-event-name"),e.el.append(a)}if(i){var r=document.createElement("i");r.innerText="star",r.classList.add("fc-event-star"),r.classList.add("material-icons"),e.el.append(r)}}},e)}function m(){D.refetchEvents(),T.refetchEvents()}function v(){5==b&&($(".sessionHide").removeClass("showSessionBar"),b=1),b+=1}function u(){$(".sessionHide").addClass("showSessionBar"),b=1,clearInterval(S),S=setInterval(v,500)}function p(){if($("#checkEventForm")){var e=window.location.href,t=new URL(e).search.split("?")[1];$("#type").val(t)}}var f=!0,w=!0,h=document.querySelectorAll(".timeline-calendar");params=e(window.location.href);var k="08:00 AM",E="08:30 AM",M=moment().format("D MMM YYYY");if(h.length){(h[0].childElementCount||h[1].childElementCount)&&(h[0].innerHTML="",h[1].innerHTML="");var D=new FullCalendar.Calendar(h[0],d());window.timelineCalendar=D;var T=new FullCalendar.Calendar(h[1],d({contentHeight:400,select:function(e){console.log(e);var t=D.view.type,n=moment.utc(moment(e.end).diff(moment(e.start))).valueOf();if(Math.floor(n/6e4)>("timeGridDay"===t?30:1440))D.unselect();else{if(D.getEvents().some(function(t){return i(t.start.getTime(),e.start.getTime(),t.end.getTime(),e.end.getTime())}))return void $("#newEventTimeConflict").modal();c({startTime:moment(e.start).format("hh:mm A"),endTime:moment(e.end).format("hh:mm A"),setDate:moment(e.start).format("D MMM YYYY")}),k=moment(e.start).format("hh:mm A"),E=moment(e.end).format("hh:mm A"),M=moment(e.start).format("D MMM YYYY")}},eventRender:function(e){var t=e.event.extendedProps.eventDescription,n=e.event.extendedProps.eventName,i=e.event.extendedProps.hasStar;if(t){var o=document.createElement("div");o.innerText=t,o.classList.add("fc-event-description"),e.el.append(o)}if(n){var a=document.createElement("div");a.innerText=n,a.classList.add("fc-event-name"),e.el.append(a)}if(i){var r=document.createElement("i");r.innerText="star",r.classList.add("fc-event-star"),r.classList.add("material-icons"),e.el.append(r)}}}));if(D.render(),T.render(),g=document.querySelector(".very-custom-calendar")){var g;g.childElementCount&&(g.innerHTML=""),(g=new FullCalendar.Calendar(g,{plugins:["dayGrid","interaction","moment"],header:{left:"",center:"",right:""},aspectRatio:1,selectable:!0,select:function(e){moment.utc(moment(e.end).diff(moment(e.start))).format("D")>2?g.unselect():(D.gotoDate(e.start),n(moment(e.start)),t(moment(e.start).format("M")))}})).render(),new PerfectScrollbar(document.querySelector(".months-wrap")),new PerfectScrollbar(document.querySelector(".fc-scroller")),$(".new-event-time-picker").mdtimepicker(),$(".new-event-date-picker").bootstrapMaterialDatePicker({weekStart:0,time:!1,format:"D MMM YYYY"});var y=moment(g.getDate()),Y=y.format("M");t(Y,!0),n(y),$(".months-wrap .month").on("click",function(){var e=$(this).attr("id").replace("month-",""),n="1",i=y.format("Y");g.gotoDate(moment(e+"-"+n+"-"+i,"MM-DD-YYYY").format()),t(e)}),$("#daily").on("click",function(){D.changeView("timeGridDay")}),$("#weekly").on("click",function(){D.changeView("dayGridWeek")}),$("#monthly").on("click",function(){D.changeView("dayGridMonth")}),$("#booking-add-event-btn").on("click",function(){var e=moment().format("D MMM YYYY");$.getScript("/sessions/new",function(){r({startTime:k,endTime:E,setDate:M}),$("#newEventAddDetailsBtn").on("click",function(){o()}),$("#newEventMoreOptionBtn").on("click",function(){$("#newEventMoreOptionDialog").modal(),c({startTime:$("#newEventStartTimepicker").val(),endTime:$("#newEventEndTimepicker").val(),setDate:e,title:$("#booking_title").val(),description:$("#newEventAddDetailsTextArea").val()})}),$(".new-event-time-picker").mdtimepicker(),$("#newEventStartTimepicker").mdtimepicker().on("timechanged",function(e){k=e.value}),$("#newEventEndTimepicker").mdtimepicker().on("timechanged",function(e){E=e.value}),$(".new-event-date-picker").bootstrapMaterialDatePicker({weekStart:0,time:!1,format:"D MMM YYYY"}),$(".new-event-date-picker").change(function(e){M=e.target.value}),$("#newEventDialog").removeClass("edit-view").modal()})}),$("#more-options-tab2-tab").on("click",function(){setTimeout(function(){T.updateSize()})}),$("#new_booking").submit(function(){return r({startTime:$("#newEventStartTimepickerMoreOption").val(),endTime:$("#newEventEndTimepickerMoreOption").val(),setDate:$("#newEventDatePickerMoreOption").val(),title:$("#newEventSubjectMoreOption").val(),description:$("#newEventAddDetailsTextAreaMoreOption").val()}),$(".start_hidden").val(M+" "+k),$(".end_hidden").val(M+" "+E),p(),!0}),$("#newEventMoreOptionTodayBtn").on("click",function(){var e=moment();T.gotoDate(e.format()),$("#newEventMoreOptionsCurrentDate").text(e.format("D MMM YYYY"))}),$("#newEventMoreOptionNextDayBtn").on("click",function(){var e=moment(T.getDate()).add(1,"day");T.gotoDate(e.format()),$("#newEventMoreOptionsCurrentDate").text(e.format("D MMM YYYY"))}),$("#newEventMoreOptionPrevDayBtn").on("click",function(){var e=moment(T.getDate()).subtract(1,"day");T.gotoDate(e.format()),$("#newEventMoreOptionsCurrentDate").text(e.format("D MMM YYYY"))}),$("#addNotifButton").on("click",function(){l()}),$("#current_user_checkbox").change(function(){w=this.checked,m()}),$("#other_user_checkbox").change(function(){f=this.checked,m()});var b=1,S=setInterval(v,500);$(".inSession").on("mousemove",u)}}}function t(e,t,n){var i;return function(){var o=this,a=arguments,r=function(){i=null,n||e.apply(o,a)},c=n&&!i;clearTimeout(i),i=setTimeout(r,t),c&&e.apply(o,a)}}var n=t(e,250);$(document).on("turbolinks:load",n),n()});