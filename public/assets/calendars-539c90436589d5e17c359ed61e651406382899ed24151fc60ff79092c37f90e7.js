$(document).ready(function(){function e(){function e(e,t){(document.getElementById("month-"+b).classList.remove("active"),document.getElementById("month-"+e).classList.add("active"),b=e,t)&&document.querySelector(".months-wrap .active").scrollIntoView()}function t(e){var t=document.querySelector(".very-custom-calendar-wrap .calendar-current-date .month-placeholder"),n=document.querySelector(".very-custom-calendar-wrap .calendar-current-date .day-placeholder");t.innerText=e.format("dddd ."),n.innerText=e.format("D MMM")}function n(e,t,n,a){return e<a&&t<n}function a(e){return e||(e={}),Object.assign({header:{left:"",center:"",right:""},plugins:["dayGrid","timeGrid","interaction"],defaultView:"timeGridDay",nowIndicator:!0,allDaySlot:!1,contentHeight:800,selectable:!0,selectHelper:!0,eventOverlap:!1,datesRender:function(){Array.from(document.querySelectorAll(".fc-scroller")).forEach(function(e){new PerfectScrollbar(e)})},eventClick:function(e){"unavailable"!==e.event.className?$.getScript(e.event.extendedProps.edit_url,function(){d({startTime:moment(e.event.start).format("hh:mm A"),endTime:moment(e.event.end).format("hh:mm A"),setDate:moment(e.event.start).format("D MMM YYYY"),title:e.event.title,description:e.event.extendedProps.eventDescription}),$(".start_hidden").val(moment(e.event.start).format("D MMM YYYY")+" "+moment(e.event.start).format("hh:mm A")),$(".end_hidden").val(moment(e.event.start).format("D MMM YYYY")+" "+moment(e.event.end).format("hh:mm A")),$("#newEventAddDetailsBtn").on("click",function(){u()}),$("#bookingEditEventEditBookingBtn").on("click",function(){$("#chagneOrCancelDialog").modal(),s({startTime:$("#newEventStartTimepicker").val(),endTime:$("#newEventEndTimepicker").val(),setDate:$("#newEventDatePicker").val()})}),$("#chagneOrCancelDialogChangeReservation").on("click",function(){$("#bookingChangeRequestDialog").modal(),v({startTime:moment(e.event.start).format("hh:mm A"),endTime:moment(e.event.end).format("hh:mm A"),setDate:moment(e.event.start).format("D MMM YYYY")})}),$("#chagneOrCancelDialogCancelReservationBtn").on("click",function(){$("#cancelSessionDialog").modal()}),$(".cancel-session").click(function(){confirm("Are you sure you want to delete this booking?")&&$.ajax({type:"DELETE",url:e.event.extendedProps.delete_url,success:()=>!0})}),$(".edit-booking").click(function(){$.ajax({type:"PATCH",url:e.event.extendedProps.delete_url,data:{booking:{title:$("#booking_title").val(),start:$("#newEventDatePicker").val()+" "+$("#newEventStartTimepicker").val(),end:$("#newEventDatePicker").val()+" "+$("#newEventEndTimepicker").val(),description:$("#newEventAddDetailsTextArea").val()}},success:()=>!0})}),$("#bookingEditEventMoreOptionDialog").on("click",function(){$("#editEventMoreOptionDialog").modal(),m({startTime:$("#newEventStartTimepicker").val(),endTime:$("#newEventEndTimepicker").val(),setDate:$("#newEventDatePicker").val(),title:$("#booking_title").val(),description:$("#newEventAddDetailsTextArea").val()})}),$("#changeSendRequestBackBtn").on("click",function(){$("#chagneOrCancelDialog").modal()}),$("#cancelDialogBoxBackBtn").on("click",function(){$("#chagneOrCancelDialog").modal()}),$(".new-event-time-picker").mdtimepicker(),$(".new-event-date-picker").bootstrapMaterialDatePicker({weekStart:0,time:!1,format:"D MMM YYYY"}),$("#newEventDialog").addClass("edit-view").modal()}):$.getScript(e.event.extendedProps.unavailable_url,function(){})},select:function(e){if(w.getEvents().some(function(t){return!(!t.start||!t.end)&&n(t.start.getTime(),e.start.getTime(),t.end.getTime(),e.end.getTime())}))$("#newEventTimeConflict").modal();else{var t=moment.utc(moment(e.end).diff(moment(e.start))).valueOf();Math.floor(t/6e4);$("#profileCalendarUnavailableDialogBox").modal(),c({startTime:moment(e.start).format("hh:mm A"),endTime:moment(e.end).format("hh:mm A"),setDate:moment(e.start).format("D MMM YYYY")})}},events:"/bookings.json?self=1&other=0",eventRender:function(e){var t=e.event.extendedProps.eventDescription,n=e.event.extendedProps.eventName,a=e.event.extendedProps.hasStar;if(t){var i=document.createElement("div");i.innerText=t,i.classList.add("fc-event-description"),e.el.append(i)}if(n){var o=document.createElement("div");o.innerText=n,o.classList.add("fc-event-name"),e.el.append(o)}if(a){var r=document.createElement("i");r.innerText="star",r.classList.add("fc-event-star"),r.classList.add("material-icons"),e.el.append(r)}}},e)}function i(){$(".checkbox-switcher").each(function(e,t){var n=(t=$(t)).find(".checkbox"),a=t.find(".rect-1"),i=t.find(".rect-2");t.mouseup(function(){t.toggleClass("h_btn"),n.toggleClass("h_cb"),a.toggleClass("h_rects"),i.toggleClass("h_rects");var e=t.parent().parent().parent().find(".time-picker-wrap");e.toggleClass("d-none"),e.next().toggleClass("d-none"),e.children().length||o(e)})})}function o(e){var t='\n        <div class="time-picker-row">\n          <input type="text" value="" class="time-picker gray-input time-picker-start"/>\n\n          <span class="mx-2">to</span>\n\n          <input type="text" value="" class="time-picker gray-input time-picker-end"/>\n\n          <button type="button" class="d-inline-block btn btn-link btn-link-close" aria-label="Close">\n            <span aria-hidden="true">&times;</span>\n          </button>\n        </div>',n=document.createElement("div");n.innerHTML=t,$(e).append(n),$(e).find(".time-picker").mdtimepicker(),$(n).find(".btn-link-close").on("click",function(){$(this).parent().parent().remove()})}function r(e,t,n){h[e]||(h[e]=[]),h[e].push([t,n])}function l(){return h={},$(".recurring-calendar-row").each(function(e,t){if(!(t=$(t)).find(".checkbox-switcher .checkbox").hasClass("h_cb")){var n=t.find(".time-picker-row"),a=t.find(".recurring-day-name").text().trim();n.each(function(e,t){var n=(t=$(t)).find(".time-picker-start").val(),i=t.find(".time-picker-end").val();r(a,n,i)})}}),$("#availabilty").val(JSON.stringify(h)),h}function c(e){var t=e.startTime,n=e.endTime,a=e.setDate;console.log(t),$(".today-placeholder").text(a),$(".start-time-placeholder").text(t),$(".end-time-placeholder").text(n),$(".start_hidden").val(moment(a).format("D MMM YYYY")+" "+t),$(".end_hidden").val(moment(a).format("D MMM YYYY")+" "+n)}function d(e){var t=e.startTime,n=e.endTime,a=e.setDate,i=e.title,o=e.description;$("#newEventStartTimepicker").val(t),$("#newEventEndTimepicker").val(n),$("#newEventDatePicker").val(a),i?$("#booking_title").val(i):$("#newEventSubject").val(""),o?($("#newEventAddDetailsTextArea").val(o),u()):($("#newEventAddDetailsTextArea").val(""),p())}function m(e){var t=e.startTime,n=e.endTime,a=e.setDate,i=e.title,o=e.description;$("#newEventStartTimepickerMoreOption").val(t),$("#newEventEndTimepickerMoreOption").val(n),$("#newEventDatePickerMoreOption").val(a),$("#newEventMoreOptionsCurrentDate").text(a),i&&$("#newEventSubjectMoreOption").val(i),o&&$("#newEventAddDetailsTextAreaMoreOption").val(o)}function s(e){var t=e.startTime,n=e.endTime,a=e.setDate;$(".start-time-placeholder").text(t),$(".end-time-placeholder").text(n),$(".today-placeholder").text(a)}function v(e){var t=e.startTime,n=e.endTime,a=e.setDate;$(".previous-start-time-placeholder").text(t),$(".previous-end-time-placeholder").text(n),$(".previous-day-placeholder").text(a)}function u(){$("#newEventAddDetails").removeClass("d-none"),$("#newEventAddDetailsBtn").addClass("d-none")}function p(){$("#newEventAddDetails").addClass("d-none"),$("#newEventAddDetailsBtn").removeClass("d-none")}function f(){var e='<div class="position-relative mt-3">\n                        <select class="custom-select mr-2 fz-14 gray-input d-inline-block notification-select">\n                          <option value="email" selected>Email</option>\n                          <option value="notification">Notification</option>\n                        </select>\n\n                        <input type="text" class="form-control mr-2 gray-input d-inline-block notification-duration-input" placeholder="30">\n\n                        <select class="custom-select fz-14 gray-input d-inline-block notification-duration-type-input">\n                          <option value="minutes" selected>minutes</option>\n                          <option value="hours">hours</option>\n                          <option value="days">days</option>\n                          <option value="weeks">weeks</option>\n                        </select>\n\n                        <button type="button" class="d-inline-block btn btn-link btn-link-close" aria-label="Close">\n                          <span aria-hidden="true">&times;</span>\n                        </button>\n                    </div>',t=document.createElement("div");t.innerHTML=e,$("#notif-wrap").append(t),$(t).find(".btn-link-close").on("click",function(){k($(this))})}function k(e){$(e).parent().remove()}if("calendars"===$("meta[name=psj]").attr("controller")){var h={},g=document.getElementById("profile-calendar-hidden-recurring-unavailable"),D=document.querySelectorAll(".personal-timeline-calendar");if(D.length){(D[0].childElementCount||D[1].childElementCount)&&(D[0].innerHTML="",D[1].innerHTML="");var w=new FullCalendar.Calendar(D[0],a()),E=new FullCalendar.Calendar(D[1],a({contentHeight:400,eventClick:function(){},select:function(e){var t=w.view.type,a=moment.utc(moment(e.end).diff(moment(e.start))).valueOf();if(Math.floor(a/6e4)>("timeGridDay"===t?30:1440))w.unselect();else{if(w.getEvents().some(function(t){return n(t.start.getTime(),e.start.getTime(),t.end.getTime(),e.end.getTime())}))return void $("#newEventTimeConflict").modal();m({startTime:moment(e.start).format("hh:mm A"),endTime:moment(e.end).format("hh:mm A"),setDate:moment(e.start).format("D MMM YYYY")})}}}));if(w.render(),E.render(),window.personalTimelineCalendar=w,window.timelineCalendarMoreOptions=E,M=document.querySelector(".personal-very-custom-calendar")){var M;M.childElementCount&&(M.innerHTML=""),(M=new FullCalendar.Calendar(M,{plugins:["dayGrid","interaction","moment"],header:{left:"",center:"",right:""},aspectRatio:1,selectable:!0,select:function(n){moment.utc(moment(n.end).diff(moment(n.start))).format("D")>2?M.unselect():(w.gotoDate(n.start),t(moment(n.start)),e(moment(n.start).format("M")))}})).render(),new PerfectScrollbar(document.querySelector(".months-wrap")),new PerfectScrollbar(document.querySelector(".fc-scroller")),$(".time-picker").mdtimepicker(),$(".new-event-date-picker").bootstrapMaterialDatePicker({weekStart:0,time:!1,format:"D MMM YYYY"}),i();var T=moment(M.getDate()),b=T.format("M");e(b,!0),t(T),$(".months-wrap .month").on("click",function(){var t=$(this).attr("id").replace("month-",""),n="1",a=T.format("Y");M.gotoDate(moment(t+"-"+n+"-"+a,"MM-DD-YYYY").format()),e(t)}),$("#daily").on("click",function(){$(this).parent().find("a").removeClass("active"),$(this).addClass("active"),w.changeView("timeGridDay")}),$("#weekly").on("click",function(){$(this).parent().find("a").removeClass("active"),$(this).addClass("active"),w.changeView("dayGridWeek")}),$("#monthly").on("click",function(){$(this).parent().find("a").removeClass("active"),$(this).addClass("active"),w.changeView("dayGridMonth")}),$(".recurringAddTimePicker").on("click",function(){o($(this).parent().parent().find(".time-picker-wrap"))}),$("#more-options-tab2-tab").on("click",function(){setTimeout(function(){E.updateSize()})}),$("#newEventAddDetailsBtn").on("click",function(){u()}),$("#newEventMoreOptionTodayBtn").on("click",function(){var e=moment();E.gotoDate(e.format()),$("#newEventMoreOptionsCurrentDate").text(e.format("D MMM YYYY"))}),$("#newEventMoreOptionNextDayBtn").on("click",function(){var e=moment(E.getDate()).add(1,"day");E.gotoDate(e.format()),$("#newEventMoreOptionsCurrentDate").text(e.format("D MMM YYYY"))}),$("#newEventMoreOptionPrevDayBtn").on("click",function(){var e=moment(E.getDate()).subtract(1,"day");E.gotoDate(e.format()),$("#newEventMoreOptionsCurrentDate").text(e.format("D MMM YYYY"))}),$("#addNotifButton").on("click",function(){f()}),$("#unavailableDialogBoxRecurrentLink").on("click",function(){$("#profileCalendarRecurringUnavailableDialogBox").modal()}),$("#profileCalendarRecurringUnavailableDialogBox").on("hidden.bs.modal",function(){$("body").removeClass("modal-open"),setTimeout(function(){$("body").removeClass("modal-open")},1e3)}),$("#profileCalendarRecurringUnavailableDialogBox").on("shown.bs.modal",function(){$("body").addClass("modal-open"),setTimeout(function(){$("body").addClass("modal-open")},1e3)}),$("#newEventMoreOptionBtn").on("click",function(){$("#editEventMoreOptionDialog").modal(),m({startTime:$("#newEventStartTimepicker").val(),endTime:$("#newEventEndTimepicker").val(),setDate:$("#newEventDatePicker").val(),title:$("#booking_title").val(),description:$("#newEventAddDetailsTextArea").val()})}),$("#editEventMoreOptionDialogEditBookingBtn").on("click",function(){$("#chagneOrCancelDialog").modal(),d({title:$("#newEventSubjectMoreOption").val(),startTime:$("#newEventStartTimepickerMoreOption").val(),endTime:$("#newEventEndTimepickerMoreOption").val(),setDate:$("#newEventDatePickerMoreOption").val(),description:$("#newEventAddDetailsTextAreaMoreOption").val()}),s({startTime:$("#newEventStartTimepickerMoreOption").val(),endTime:$("#newEventEndTimepickerMoreOption").val(),setDate:$("#newEventDatePickerMoreOption").val()})}),$("#availabiltyNextBtn").on("click",function(){g&&(g.text=JSON.stringify(l())),console.log(l())})}}}}$(document).on("turbolinks:load",e),e()});